<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
</head>
<body>
  <h1 style="text-align:center;">กำลังพาไปที่ฟอร์ม...</h1>
  <script>
    const liffId = "1660731963-K7lzz7v4";
    const googleFormUrl = "https://docs.google.com/forms/d/e/1FAIpQLSfNfyi4z15GPZhY9XGfDHFAI9RFcGvq1-VKbOAUcbi7zlqYkA/viewform";

    async function startLiff() {
      try {
        await liff.init({ liffId: liffId });
        if (!liff.isLoggedIn()) {
          liff.login();
        } else {
          const profile = await liff.getProfile();
          const finalUrl = `${googleFormUrl}?usp=pp_url` +
            `&entry.1827155689=${encodeURIComponent(profile.userId)}` +
            `&entry.2062207086=${encodeURIComponent(profile.displayName)}` +
            `&entry.1203911146=${encodeURIComponent(profile.pictureUrl || '')}`;
          
          window.location.replace(finalUrl);
        }
      } catch (err) {
        alert("Error: " + err);
      }
    }
    startLiff();
  </script>
</body>
</html>